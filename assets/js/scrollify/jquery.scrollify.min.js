/*!
 * jQuery Scrollify
 * Version 1.0.21
 *
 * Requires:
 * - jQuery 1.7 or higher
 *
 * https://github.com/lukehaas/Scrollify
 *
 * Copyright 2016, Luke Haas
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
 * the Software, and to permit persons to whom the Software is furnished to do so,
 * subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
 * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
 * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
 * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
 * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.



if touchScroll is false - update index

 */
!function(global,factory){"use strict";"function"==typeof define&&define.amd?define(["jquery"],(function($){return factory($,global,global.document)})):"object"==typeof module&&module.exports?module.exports=factory(require("jquery"),global,global.document):factory(jQuery,global,global.document)}("undefined"!=typeof window?window:this,(function($,window,document,undefined){"use strict";var heights=[],names=[],elements=[],overflow=[],index=0,currentIndex=0,interstitialIndex=1,hasLocation=!1,timeoutId,timeoutId2,$window=$(window),portHeight,top=$window.scrollTop(),scrollable=!1,locked=!1,scrolled=!1,manualScroll,swipeScroll,util,disabled=!1,scrollSamples=[],scrollTime=(new Date).getTime(),firstLoad=!0,initialised=!1,destination=0,wheelEvent="onwheel"in document?"wheel":document.onmousewheel!==undefined?"mousewheel":"DOMMouseScroll",eventListenerOptions={passive:!1},settings={section:".section",sectionName:"section-name",interstitialSection:"",easing:"easeOutExpo",scrollSpeed:1100,offset:0,scrollbars:!0,target:"html,body",standardScrollElements:!1,setHeights:!0,overflowScroll:!0,updateHash:!0,touchScroll:!0,before:function(){},after:function(){},afterResize:function(){},afterRender:function(){}};function getportHeight(){return window.innerHeight+settings.offset}function animateScroll(index,instant,callbacks,toTop){if(currentIndex===index&&(callbacks=!1),!0===disabled)return!0;if(names[index]){if(scrollable=!1,!0===firstLoad&&(firstLoad=!1,settings.afterRender()),callbacks&&"function"==typeof settings.before&&!1===settings.before(index,elements))return!0;if(interstitialIndex=1,destination=index?heights[index]:0,!1===firstLoad&&currentIndex>index&&!1===toTop&&overflow[index]&&(portHeight=getportHeight(),interstitialIndex=parseInt(elements[index].outerHeight()/portHeight),destination=parseInt(heights[index])+(elements[index].outerHeight()-portHeight)),settings.updateHash&&settings.sectionName&&(!0!==firstLoad||0!==index))if(history.pushState)try{history.replaceState(null,null,names[index])}catch(e){window.console&&console.warn("Scrollify warning: Page must be hosted to manipulate the hash value.")}else window.location.hash=names[index];if(currentIndex=index,instant)$(settings.target).stop().scrollTop(destination),callbacks&&settings.after(index,elements);else{if(locked=!0,$().velocity?$(settings.target).stop().velocity("scroll",{duration:settings.scrollSpeed,easing:settings.easing,offset:destination,mobileHA:!1}):$(settings.target).stop().animate({scrollTop:destination},settings.scrollSpeed,settings.easing),window.location.hash.length&&settings.sectionName&&window.console)try{$(window.location.hash).length&&console.warn("Scrollify warning: ID matches hash value - this will cause the page to anchor.")}catch(e){}$(settings.target).promise().done((function(){locked=!1,firstLoad=!1,callbacks&&settings.after(index,elements)}))}}}function isAccelerating(samples){function average(num){for(var sum=0,lastElements=samples.slice(Math.max(samples.length-num,1)),i=0;i<lastElements.length;i++)sum+=lastElements[i];return Math.ceil(sum/num)}var avEnd,avMiddle;return average(10)>=average(70)}var scrollify=function(options){function interstitialScroll(pos){$().velocity?$(settings.target).stop().velocity("scroll",{duration:settings.scrollSpeed,easing:settings.easing,offset:pos,mobileHA:!1}):$(settings.target).stop().animate({scrollTop:pos},settings.scrollSpeed,settings.easing)}function sizePanels(keepPosition){keepPosition&&(top=$window.scrollTop());var selector=settings.section;overflow=[],settings.interstitialSection.length&&(selector+=","+settings.interstitialSection),!1===settings.scrollbars&&(settings.overflowScroll=!1),portHeight=getportHeight(),$(selector).each((function(i){var $this=$(this);settings.setHeights?$this.is(settings.interstitialSection)?overflow[i]=!1:$this.css("height","auto").outerHeight()<portHeight||"hidden"===$this.css("overflow")?($this.css({height:portHeight}),overflow[i]=!1):($this.css({height:$this.outerHeight()}),settings.overflowScroll?overflow[i]=!0:overflow[i]=!1):$this.outerHeight()<portHeight||!1===settings.overflowScroll?overflow[i]=!1:overflow[i]=!0})),keepPosition&&$window.scrollTop(top)}function calculatePositions(scroll,firstLoad){var selector=settings.section;settings.interstitialSection.length&&(selector+=","+settings.interstitialSection),heights=[],names=[],elements=[],$(selector).each((function(i){var $this=$(this);heights[i]=i>0?parseInt($this.offset().top)+settings.offset:parseInt($this.offset().top),settings.sectionName&&$this.data(settings.sectionName)?names[i]="#"+$this.data(settings.sectionName).toString().replace(/ /g,"-"):!1===$this.is(settings.interstitialSection)?names[i]="#"+(i+1):(names[i]="#",i===$(selector).length-1&&i>1&&(heights[i]=heights[i-1]+(parseInt($($(selector)[i-1]).outerHeight())-parseInt($(window).height()))+parseInt($this.outerHeight()))),elements[i]=$this;try{$(names[i]).length&&window.console&&console.warn("Scrollify warning: Section names can't match IDs - this will cause the browser to anchor.")}catch(e){}window.location.hash===names[i]&&(index=i,hasLocation=!0)})),!0===scroll&&animateScroll(index,!1,!1,!1)}function atTop(){return!overflow[index]||!((top=$window.scrollTop())>parseInt(heights[index]))}function atBottom(){return!overflow[index]||(top=$window.scrollTop(),portHeight=getportHeight(),!(top<parseInt(heights[index])+(elements[index].outerHeight()-portHeight)-28))}initialised=!0,$.easing.easeOutExpo=function(x,t,b,c,d){return t==d?b+c:c*(1-Math.pow(2,-10*t/d))+b},manualScroll={handleMousedown:function(){if(!0===disabled)return!0;scrollable=!1,scrolled=!1},handleMouseup:function(){if(!0===disabled)return!0;scrollable=!0,scrolled&&manualScroll.calculateNearest(!1,!0)},handleScroll:function(){if(!0===disabled)return!0;timeoutId&&clearTimeout(timeoutId),timeoutId=setTimeout((function(){if(scrolled=!0,!1===scrollable)return!1;scrollable=!1,manualScroll.calculateNearest(!1,!0)}),200)},calculateNearest:function(instant,callbacks){top=$window.scrollTop();for(var i=1,max=heights.length,closest=0,prev=Math.abs(heights[0]-top),diff;i<max;i++)(diff=Math.abs(heights[i]-top))<prev&&(prev=diff,closest=i);(atBottom()&&closest>index||atTop())&&(index=closest,animateScroll(closest,instant,callbacks,!1))},wheelHandler:function(e){if(!0===disabled)return!0;if(settings.standardScrollElements&&($(e.target).is(settings.standardScrollElements)||$(e.target).closest(settings.standardScrollElements).length))return!0;overflow[index]||e.preventDefault();var currentScrollTime=(new Date).getTime(),value;value=(e=e||window.event).originalEvent?e.originalEvent.wheelDelta||-e.originalEvent.deltaY||-e.originalEvent.detail:e.wheelDelta||-e.deltaY||-e.detail;var delta=Math.max(-1,Math.min(1,value));if(scrollSamples.length>149&&scrollSamples.shift(),scrollSamples.push(Math.abs(value)),currentScrollTime-scrollTime>200&&(scrollSamples=[]),scrollTime=currentScrollTime,locked)return!1;if(delta<0){if(index<heights.length-1&&atBottom()){if(!isAccelerating(scrollSamples))return!1;e.preventDefault(),index++,locked=!0,animateScroll(index,!1,!0,!1)}}else if(delta>0&&index>0&&atTop()){if(!isAccelerating(scrollSamples))return!1;e.preventDefault(),index--,locked=!0,animateScroll(index,!1,!0,!1)}},keyHandler:function(e){return!0===disabled||!1===document.activeElement.readOnly||(!(!settings.standardScrollElements||!$(e.target).is(settings.standardScrollElements)&&!$(e.target).closest(settings.standardScrollElements).length)||!0!==locked&&void(38==e.keyCode||33==e.keyCode?index>0&&atTop()&&(e.preventDefault(),animateScroll(--index,!1,!0,!1)):40!=e.keyCode&&34!=e.keyCode||index<heights.length-1&&atBottom()&&(e.preventDefault(),animateScroll(++index,!1,!0,!1))))},init:function(){settings.scrollbars?($window.on("mousedown",manualScroll.handleMousedown),$window.on("mouseup",manualScroll.handleMouseup),$window.on("scroll",manualScroll.handleScroll)):$("body").css({overflow:"hidden"}),window.addEventListener(wheelEvent,manualScroll.wheelHandler,{passive:!1}),$window.on("keydown",manualScroll.keyHandler)}},swipeScroll={touches:{touchstart:{y:-1,x:-1},touchmove:{y:-1,x:-1},touchend:!1,direction:"undetermined"},options:{distance:30,timeGap:800,timeStamp:(new Date).getTime()},touchHandler:function(event){if(!0===disabled)return!0;if(settings.standardScrollElements&&($(event.target).is(settings.standardScrollElements)||$(event.target).closest(settings.standardScrollElements).length))return!0;var touch;if(void 0!==event&&void 0!==event.touches)switch(touch=event.touches[0],event.type){case"touchstart":swipeScroll.touches.touchstart.y=touch.pageY,swipeScroll.touches.touchmove.y=-1,swipeScroll.touches.touchstart.x=touch.pageX,swipeScroll.touches.touchmove.x=-1,swipeScroll.options.timeStamp=(new Date).getTime(),swipeScroll.touches.touchend=!1;case"touchmove":swipeScroll.touches.touchmove.y=touch.pageY,swipeScroll.touches.touchmove.x=touch.pageX,swipeScroll.touches.touchstart.y!==swipeScroll.touches.touchmove.y&&Math.abs(swipeScroll.touches.touchstart.y-swipeScroll.touches.touchmove.y)>Math.abs(swipeScroll.touches.touchstart.x-swipeScroll.touches.touchmove.x)&&(event.preventDefault(),swipeScroll.touches.direction="y",swipeScroll.options.timeStamp+swipeScroll.options.timeGap<(new Date).getTime()&&0==swipeScroll.touches.touchend&&(swipeScroll.touches.touchend=!0,swipeScroll.touches.touchstart.y>-1&&Math.abs(swipeScroll.touches.touchmove.y-swipeScroll.touches.touchstart.y)>swipeScroll.options.distance&&(swipeScroll.touches.touchstart.y<swipeScroll.touches.touchmove.y?swipeScroll.up():swipeScroll.down())));break;case"touchend":!1===swipeScroll.touches[event.type]&&(swipeScroll.touches[event.type]=!0,swipeScroll.touches.touchstart.y>-1&&swipeScroll.touches.touchmove.y>-1&&"y"===swipeScroll.touches.direction&&(Math.abs(swipeScroll.touches.touchmove.y-swipeScroll.touches.touchstart.y)>swipeScroll.options.distance&&(swipeScroll.touches.touchstart.y<swipeScroll.touches.touchmove.y?swipeScroll.up():swipeScroll.down()),swipeScroll.touches.touchstart.y=-1,swipeScroll.touches.touchstart.x=-1,swipeScroll.touches.direction="undetermined"))}},down:function(){index<heights.length&&(atBottom()&&index<heights.length-1?animateScroll(++index,!1,!0,!1):(portHeight=getportHeight(),Math.floor(elements[index].height()/portHeight)>interstitialIndex?(interstitialScroll(parseInt(heights[index])+portHeight*interstitialIndex),interstitialIndex+=1):interstitialScroll(parseInt(heights[index])+(elements[index].outerHeight()-portHeight))))},up:function(){index>=0&&(atTop()&&index>0?animateScroll(--index,!1,!0,!1):interstitialIndex>2?(portHeight=getportHeight(),interstitialIndex-=1,interstitialScroll(parseInt(heights[index])+portHeight*interstitialIndex)):(interstitialIndex=1,interstitialScroll(parseInt(heights[index]))))},init:function(){document.addEventListener&&settings.touchScroll&&(document.addEventListener("touchstart",swipeScroll.touchHandler,eventListenerOptions),document.addEventListener("touchmove",swipeScroll.touchHandler,eventListenerOptions),document.addEventListener("touchend",swipeScroll.touchHandler,eventListenerOptions))}},util={refresh:function(withCallback,scroll){clearTimeout(timeoutId2),timeoutId2=setTimeout((function(){sizePanels(!0),calculatePositions(scroll,!1),withCallback&&settings.afterResize()}),400)},handleUpdate:function(){util.refresh(!1,!1)},handleResize:function(){util.refresh(!0,!1)},handleOrientation:function(){util.refresh(!0,!0)}},settings=$.extend(settings,options),sizePanels(!1),calculatePositions(!1,!0),!0===hasLocation?animateScroll(index,!1,!0,!0):setTimeout((function(){manualScroll.calculateNearest(!0,!1)}),200),heights.length&&(manualScroll.init(),swipeScroll.init(),$window.on("resize",util.handleResize),document.addEventListener&&window.addEventListener("orientationchange",util.handleOrientation,!1))};function move(panel,instant){for(var z=names.length;z>=0;z--)"string"==typeof panel?names[z]===panel&&(index=z,animateScroll(z,instant,!0,!0)):z===panel&&(index=z,animateScroll(z,instant,!0,!0))}return scrollify.move=function(panel){if(panel===undefined)return!1;"number"!=typeof panel&&panel.originalEvent&&(panel=$(this).attr("href")),move(panel,!1)},scrollify.instantMove=function(panel){if(panel===undefined)return!1;move(panel,!0)},scrollify.next=function(){index<names.length&&animateScroll(index+=1,!1,!0,!0)},scrollify.previous=function(){index>0&&animateScroll(index-=1,!1,!0,!0)},scrollify.instantNext=function(){index<names.length&&animateScroll(index+=1,!0,!0,!0)},scrollify.instantPrevious=function(){index>0&&animateScroll(index-=1,!0,!0,!0)},scrollify.destroy=function(){if(!initialised)return!1;settings.setHeights&&$(settings.section).each((function(){$(this).css("height","auto")})),$window.off("resize",util.handleResize),settings.scrollbars&&($window.off("mousedown",manualScroll.handleMousedown),$window.off("mouseup",manualScroll.handleMouseup),$window.off("scroll",manualScroll.handleScroll)),window.removeEventListener(wheelEvent,manualScroll.wheelHandler),$window.off("keydown",manualScroll.keyHandler),document.addEventListener&&settings.touchScroll&&(document.removeEventListener("touchstart",swipeScroll.touchHandler,eventListenerOptions),document.removeEventListener("touchmove",swipeScroll.touchHandler,eventListenerOptions),document.removeEventListener("touchend",swipeScroll.touchHandler,eventListenerOptions)),heights=[],names=[],elements=[],overflow=[],firstLoad=!0,initialised=!1},scrollify.update=function(){if(!initialised)return!1;util.handleUpdate()},scrollify.current=function(){return elements[index]},scrollify.currentIndex=function(){return index},scrollify.disable=function(){disabled=!0},scrollify.enable=function(){disabled=!1,initialised&&manualScroll.calculateNearest(!1,!1)},scrollify.isDisabled=function(){return disabled},scrollify.setOptions=function(updatedOptions){if(!initialised)return!1;"object"==typeof updatedOptions?(settings=$.extend(settings,updatedOptions),util.handleUpdate()):window.console&&console.warn("Scrollify warning: setOptions expects an object.")},$.scrollify=scrollify,scrollify}));